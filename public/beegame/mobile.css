/* Mobile-First CSS for Multiplayer Driving Game */
/* Optimized for 90% mobile user base */

/* ðŸš€ ULTIMATE FIX: Force mobile controls to ALWAYS be visible */
@media only screen and (max-width: 950px) {
    /* FORCE VISIBILITY: Mobile controls container */
    body #mobile-controls,
    #mobile-controls {
        display: block !important;
        position: fixed !important;
        z-index: 999999 !important;
        width: 100vw !important;
        height: 100vh !important;
        pointer-events: none !important;
        top: 0 !important;
        left: 0 !important;
        visibility: visible !important;
        opacity: 1 !important;
    }
    
    /* ðŸŽ¯ NUCLEAR FORCE: Attack Mode Bar - NEVER HIDE */
    body #mobile-attack-mode-bar,
    #mobile-attack-mode-bar {
        display: flex !important;
        position: fixed !important;
        z-index: 999999 !important;
        visibility: visible !important;
        opacity: 1 !important;
        pointer-events: auto !important;
        bottom: 22vh !important; /* iPhone 12 Pro: 22% from bottom */
        left: 50% !important;
        transform: translateX(-50%) !important;
        gap: 8px !important;
    }
    
    /* ðŸŽ¯ NUCLEAR FORCE: Attack Mode Buttons - NEVER HIDE */
    body .mobile-attack-mode-btn,
    .mobile-attack-mode-btn {
        display: flex !important;
        position: relative !important;
        visibility: visible !important;
        opacity: 1 !important;
        pointer-events: auto !important;
        min-width: 36px !important;
        min-height: 36px !important;
        font-size: 1.2em !important;
        border-radius: 50% !important;
        background: rgba(255,255,255,0.2) !important;
        color: rgba(255,215,0,0.9) !important;
        border: 2px solid rgba(255,215,0,0.6) !important;
        box-shadow: 0 2px 8px rgba(0,0,0,0.3) !important;
        align-items: center !important;
        justify-content: center !important;
        touch-action: manipulation !important;
        -webkit-tap-highlight-color: transparent !important;
    }
    
    /* FORCE VISIBILITY: Joystick - NEVER HIDE */
    .joystick-container {
        position: absolute !important;
        display: flex !important;
        visibility: visible !important;
        opacity: 1 !important;
        pointer-events: auto !important;
        z-index: 1000000 !important;
        bottom: 8vh !important; /* iPhone 12 Pro: 8% from bottom */
        left: 7vw !important; /* iPhone 12 Pro: 7% from left */
        width: 120px !important;
        height: 120px !important;
    }
    
    .joystick {
        width: 100% !important;
        height: 100% !important;
        background: rgba(255, 255, 255, 0.2) !important;
        border: 3px solid rgba(255, 255, 255, 0.5) !important;
        border-radius: 50% !important;
        position: relative !important;
        pointer-events: auto !important;
        touch-action: none !important;
        display: flex !important;
        visibility: visible !important;
        opacity: 1 !important;
    }
    
    .joystick-knob {
        width: 40px !important;
        height: 40px !important;
        background: radial-gradient(circle at 30% 30%, rgba(255, 235, 59, 0.95), rgba(255, 215, 0, 0.9)) !important;
        border: 2px solid rgba(255, 255, 255, 0.9) !important;
        border-radius: 50% !important;
        position: absolute !important;
        top: 50% !important;
        left: 50% !important;
        transform: translate(-50%, -50%) !important;
        pointer-events: none !important;
        box-shadow: 0 3px 12px rgba(0, 0, 0, 0.4), inset 0 1px 2px rgba(255, 255, 255, 0.3) !important;
        display: block !important;
        visibility: visible !important;
        opacity: 1 !important;
        transition: all 0.1s cubic-bezier(0.25, 0.8, 0.25, 1) !important;
    }
    
    /* FORCE VISIBILITY: Mobile Buttons - NEVER HIDE */
    .mobile-buttons {
        position: absolute !important;
        display: flex !important;
        flex-direction: column !important;
        visibility: visible !important;
        opacity: 1 !important;
        pointer-events: auto !important;
        z-index: 1000000 !important;
        bottom: 8vh !important; /* iPhone 12 Pro: 8% from bottom */
        right: 7vw !important; /* iPhone 12 Pro: 7% from right */
        gap: 15px !important;
    }

    /* FORCE VISIBILITY: Individual Buttons - NEVER HIDE */
    .mobile-btn,
    #fly-up-btn,
    #fly-down-btn,
    #attack-btn {
        width: 60px !important;
        height: 60px !important;
        background: rgba(255, 215, 0, 0.9) !important;
        border: 3px solid rgba(255, 255, 255, 0.8) !important;
        border-radius: 50% !important;
        color: white !important;
        font-size: 24px !important;
        font-weight: bold !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
        pointer-events: auto !important;
        touch-action: manipulation !important;
        user-select: none !important;
        -webkit-user-select: none !important;
        -webkit-tap-highlight-color: transparent !important;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3) !important;
        transition: all 0.1s ease !important;
        visibility: visible !important;
        opacity: 1 !important;
        position: relative !important;
    }

    .mobile-btn:active,
    .mobile-btn.active {
        background: rgba(255, 100, 100, 0.9) !important;
        transform: scale(0.95) !important;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3) !important;
}

    /* Specific button styles */
    .fly-up-btn {
        background: rgba(100, 150, 255, 0.9) !important;
    }
    
    .fly-down-btn {
        background: rgba(100, 255, 150, 0.9) !important;
    }
    
    .attack-btn {
        background: rgba(255, 100, 100, 0.9) !important;
        font-size: 20px !important;
    }
    
    /* ðŸš€ LANDSCAPE MODE: Force everything visible with correct positioning */
    @media (orientation: landscape) {
        /* Container positioning for landscape */
        .joystick-container {
            bottom: 5vh !important;
            left: 5vw !important;
            width: 140px !important;
            height: 140px !important;
            display: flex !important;
            visibility: visible !important;
            opacity: 1 !important;
            pointer-events: auto !important;
        }
        
        .joystick {
            background: rgba(255, 255, 255, 0.25) !important;
            border: 3px solid rgba(255, 215, 0, 0.8) !important;
            display: flex !important;
            visibility: visible !important;
            opacity: 1 !important;
        }
        
        .joystick-knob {
            width: 50px !important;
            height: 50px !important;
            background: linear-gradient(45deg, #ffd700, #ffed4e) !important;
            border: 2px solid rgba(255, 255, 255, 0.9) !important;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3) !important;
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
        }

        /* Buttons positioning for landscape */
        .mobile-buttons {
            bottom: 5vh !important;
            right: 5vw !important;
            gap: 15px !important;
            display: flex !important;
            flex-direction: column !important;
            visibility: visible !important;
            opacity: 1 !important;
            pointer-events: auto !important;
        }

        /* Individual buttons for landscape */
        .mobile-btn,
        #fly-up-btn,
        #fly-down-btn,
        #attack-btn {
            width: 65px !important;
            height: 65px !important;
            font-size: 22px !important;
            border: 3px solid rgba(255, 255, 255, 0.8) !important;
            display: flex !important;
            visibility: visible !important;
            opacity: 1 !important;
            pointer-events: auto !important;
        }
        
        #fly-up-btn {
            background: linear-gradient(45deg, #4a90e2, #7bb3f0) !important;
        }

        #fly-down-btn {
            background: linear-gradient(45deg, #50c878, #7ed897) !important;
        }
        
        #attack-btn {
            background: linear-gradient(45deg, #ff6b6b, #ff8e8e) !important;
            font-size: 18px !important;
        }
        
        /* ðŸŽ¯ ATTACK MODE BAR - LANDSCAPE */
        #mobile-attack-mode-bar {
            position: fixed !important;
            bottom: 8vh !important;
            left: 50% !important;
            transform: translateX(-50%) !important;
            display: flex !important;
            gap: 10px !important;
            z-index: 999999 !important;
            visibility: visible !important;
            opacity: 1 !important;
            pointer-events: auto !important;
        }
        
        .mobile-attack-mode-btn {
            min-width: 42px !important;
            min-height: 42px !important;
            font-size: 1.4em !important;
            display: flex !important;
            visibility: visible !important;
            opacity: 1 !important;
            pointer-events: auto !important;
            border-radius: 50% !important;
            background: rgba(255,255,255,0.2) !important;
            color: rgba(255,215,0,0.9) !important;
            border: 2px solid rgba(255,215,0,0.6) !important;
            box-shadow: 0 2px 8px rgba(0,0,0,0.3) !important;
        }
    }

    /* ðŸš€ PORTRAIT MODE: Force everything visible with correct positioning */
    @media (orientation: portrait) {
        /* Container positioning for portrait - iPhone 12 Pro optimized */
        .joystick-container {
            bottom: 10vh !important; /* iPhone 12 Pro: 10% from bottom */
            left: 8vw !important; /* iPhone 12 Pro: 8% from left */
            width: 110px !important;
            height: 110px !important;
            display: flex !important;
            visibility: visible !important;
            opacity: 1 !important;
            pointer-events: auto !important;
        }
        
        .joystick {
            background: rgba(255, 255, 255, 0.2) !important;
            border: 3px solid rgba(255, 215, 0, 0.7) !important;
            display: flex !important;
            visibility: visible !important;
            opacity: 1 !important;
        }
        
        .joystick-knob {
            width: 45px !important;
            height: 45px !important;
            background: linear-gradient(45deg, #ffd700, #ffed4e) !important;
            border: 2px solid rgba(255, 255, 255, 0.8) !important;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3) !important;
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
        }

        /* Buttons positioning for portrait - iPhone 12 Pro optimized */
        .mobile-buttons {
            bottom: 10vh !important; /* iPhone 12 Pro: 10% from bottom */
            right: 8vw !important; /* iPhone 12 Pro: 8% from right */
            gap: 12px !important;
            display: flex !important;
            flex-direction: column !important;
            visibility: visible !important;
            opacity: 1 !important;
            pointer-events: auto !important;
        }

        /* Individual buttons for portrait */
        .mobile-btn,
        #fly-up-btn,
        #fly-down-btn,
        #attack-btn {
            width: 58px !important;
            height: 58px !important;
            font-size: 20px !important;
            border: 3px solid rgba(255, 255, 255, 0.8) !important;
            display: flex !important;
            visibility: visible !important;
            opacity: 1 !important;
            pointer-events: auto !important;
        }
        
        #attack-btn {
            background: linear-gradient(45deg, #ff6b6b, #ff8e8e) !important;
            font-size: 16px !important;
        }
        
        /* ðŸŽ¯ ATTACK MODE BAR - PORTRAIT - iPhone 12 Pro optimized */
        #mobile-attack-mode-bar {
            position: fixed !important;
            bottom: 25vh !important; /* iPhone 12 Pro: 25% from bottom */
            left: 50% !important;
            transform: translateX(-50%) !important;
            display: flex !important;
            gap: 8px !important;
            z-index: 999999 !important;
            visibility: visible !important;
            opacity: 1 !important;
            pointer-events: auto !important;
        }
        
        .mobile-attack-mode-btn {
            min-width: 34px !important;
            min-height: 34px !important;
            font-size: 1.1em !important;
            display: flex !important;
            visibility: visible !important;
            opacity: 1 !important;
            pointer-events: auto !important;
            border-radius: 50% !important;
            background: rgba(255,255,255,0.2) !important;
            color: rgba(255,215,0,0.9) !important;
            border: 2px solid rgba(255,215,0,0.6) !important;
            box-shadow: 0 2px 8px rgba(0,0,0,0.3) !important;
        }
    }
    
    /* Hide desktop controls help on mobile */
    body.mobile-mode .controls-help {
        display: none !important;
    }
}

/* ðŸ“± SAFE AREA SUPPORT FOR iOS DEVICES */
@supports (padding: max(0px, env(safe-area-inset-bottom))) {
    @media only screen and (max-width: 950px) {
        .joystick-container {
            bottom: max(8vh, calc(8vh + env(safe-area-inset-bottom))) !important;
            left: max(7vw, calc(7vw + env(safe-area-inset-left))) !important;
        }
        
        .mobile-buttons {
            bottom: max(8vh, calc(8vh + env(safe-area-inset-bottom))) !important;
            right: max(7vw, calc(7vw + env(safe-area-inset-right))) !important;
        }
        
        #mobile-attack-mode-bar {
            bottom: max(22vh, calc(22vh + env(safe-area-inset-bottom))) !important;
        }
        
        @media (orientation: portrait) {
            .joystick-container {
                bottom: max(10vh, calc(10vh + env(safe-area-inset-bottom))) !important;
                left: max(8vw, calc(8vw + env(safe-area-inset-left))) !important;
            }
            
            .mobile-buttons {
                bottom: max(10vh, calc(10vh + env(safe-area-inset-bottom))) !important;
                right: max(8vw, calc(8vw + env(safe-area-inset-right))) !important;
            }
            
            #mobile-attack-mode-bar {
                bottom: max(25vh, calc(25vh + env(safe-area-inset-bottom))) !important;
            }
        }
    }
}

/* âœ… MODERN LOGIN SCREEN STYLES */
@media only screen and (max-width: 950px) {
    /* Modern login overlay responsive design */
    #loginOverlay {
        padding: 10px !important;
        box-sizing: border-box;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
        min-height: 100vh !important;
        width: 100vw !important;
        position: fixed !important;
        top: 0 !important;
        left: 0 !important;
        overflow-y: auto !important;
        -webkit-overflow-scrolling: touch;
    }
    
    /* Login form mobile optimizations */
    #loginOverlay > div {
        width: 95% !important;
        max-width: 400px !important;
        min-width: 280px !important;
        padding: 20px !important;
        margin: 10px auto !important;
        border-radius: 15px !important;
        box-shadow: 0 10px 30px rgba(0,0,0,0.5) !important;
    }
    
    /* Mobile-optimized input fields */
    #playerNameInput {
        width: calc(100% - 24px) !important;
        padding: 12px !important;
        font-size: 16px !important; /* Prevents zoom on iOS */
        border-radius: 12px !important;
        border: 2px solid rgba(255,255,255,0.3) !important;
        background: rgba(255,255,255,0.1) !important;
        color: white !important;
        text-align: center;
        box-sizing: border-box;
    }
    
    #playerNameInput::placeholder {
        color: rgba(255,255,255,0.7) !important;
        font-size: 15px;
    }
    
    /* Web3 wallet buttons mobile styling */
    #connectWalletBtn, #claimRewardsBtn {
        min-width: 110px !important;
        padding: 10px 16px !important;
        font-size: 0.85rem !important;
        border-radius: 20px !important;
        margin: 5px !important;
        touch-action: manipulation;
        -webkit-tap-highlight-color: transparent;
    }
    
    /* Quick join button mobile optimization */
    button[onclick*="startGameWithTeam"] {
        width: 100% !important;
        padding: 14px !important;
        font-size: 1rem !important;
        border-radius: 12px !important;
        margin-bottom: 12px !important;
        touch-action: manipulation;
        -webkit-tap-highlight-color: transparent;
    }
    
    /* Team selection buttons for mobile */
    #teamSelection button {
        flex: 1 !important;
        padding: 12px 8px !important;
        font-size: 0.8rem !important;
        border-radius: 12px !important;
        margin: 2px !important;
        touch-action: manipulation;
        -webkit-tap-highlight-color: transparent;
    }
    
    /* Wallet status and balance display */
    #walletStatus, #balanceDisplay {
        font-size: 0.85rem !important;
        margin-bottom: 12px !important;
        word-break: break-word;
        text-align: center;
    }
    
    /* Form title mobile optimization */
    #loginOverlay h1 {
        font-size: 1.5rem !important;
        margin: 0 0 15px 0 !important;
        line-height: 1.2;
        text-align: center;
    }
    
    /* Game info text mobile styling */
    #loginOverlay div[style*="color: rgba(255,255,255,0.9)"] {
        font-size: 0.8rem !important;
        line-height: 1.3 !important;
        margin-bottom: 15px !important;
        text-align: center;
    }
    
    /* Team toggle button mobile styling */
    div[onclick*="teamSelection"] {
        font-size: 0.8rem !important;
        padding: 8px !important;
        margin-bottom: 12px !important;
        text-align: center;
        cursor: pointer;
        touch-action: manipulation;
        -webkit-tap-highlight-color: transparent;
    }
    
    /* Web3 buttons container mobile layout */
    #loginOverlay div[style*="display: flex"][style*="gap: 10px"] {
        flex-direction: column !important;
        gap: 8px !important;
        align-items: stretch !important;
    }
    
    /* Hide team selection initially */
    #teamSelection {
        margin-top: 10px !important;
        gap: 8px !important;
    }
    
    /* Make all buttons mobile-friendly */
    #loginOverlay button {
        transition: all 0.2s ease !important;
        -webkit-user-select: none;
        user-select: none;
        outline: none;
    }
    
    #loginOverlay button:active {
        transform: scale(0.95) !important;
    }
    
    /* Responsive button hover effects for touch devices */
    @media (hover: none) and (pointer: coarse) {
        #loginOverlay button:hover {
            transform: none !important;
        }
        
        #loginOverlay button:active {
            opacity: 0.8 !important;
            transform: scale(0.95) !important;
        }
    }
}

/* âœ… PORTRAIT MODE SPECIFIC LOGIN ADJUSTMENTS */
@media only screen and (max-width: 950px) and (orientation: portrait) {
    #loginOverlay {
        padding: 15px 10px !important;
    }
    
    #loginOverlay > div {
        margin: 15px auto !important;
        max-height: 85vh !important;
        overflow-y: auto !important;
    }
    
    /* Stack web3 buttons vertically in portrait */
    #loginOverlay div[style*="display: flex"][style*="gap: 10px"] {
        flex-direction: column !important;
    }
    
    #connectWalletBtn, #claimRewardsBtn {
        width: 100% !important;
        margin: 4px 0 !important;
    }
}

/* âœ… LANDSCAPE MODE SPECIFIC LOGIN ADJUSTMENTS */
@media only screen and (max-width: 950px) and (orientation: landscape) {
    #loginOverlay {
        padding: 5px !important;
    }
    
    #loginOverlay > div {
        max-width: 450px !important;
        padding: 15px !important;
        margin: 5px auto !important;
        max-height: 95vh !important;
        overflow-y: auto !important;
    }
    
    #loginOverlay h1 {
        font-size: 1.3rem !important;
        margin-bottom: 10px !important;
    }
    
    /* Keep web3 buttons side by side in landscape if space allows */
    #loginOverlay div[style*="display: flex"][style*="gap: 10px"] {
        flex-direction: row !important;
    }
}

/* âœ… ENHANCED: Orientation-independent tutorial styles */
@media only screen and (max-width: 950px) {
    #gameTutorial {
        position: fixed !important;
        top: 50% !important;
        left: 50% !important;
        transform: translate(-50%, -50%) !important;
        max-width: 90vw !important;
        max-height: 85vh !important;
        overflow-y: auto !important;
        z-index: 10001 !important;
        box-sizing: border-box !important;
    }
    
    /* Portrait-specific tutorial adjustments */
    @media (orientation: portrait) {
        #gameTutorial {
            padding: 15px 20px !important;
            font-size: 14px !important;
        }
        
        #gameTutorial h2 {
            font-size: 18px !important;
            margin-bottom: 12px !important;
        }
    }
    
    /* Landscape-specific tutorial adjustments */
    @media (orientation: landscape) {
        #gameTutorial {
            padding: 10px 15px !important;
            font-size: 12px !important;
            transform: translate(-50%, -50%) scale(0.9) !important;
        }
        
        #gameTutorial h2 {
            font-size: 16px !important;
            margin-bottom: 8px !important;
        }
        
        #gameTutorial div[style*="margin-bottom"] {
            margin-bottom: 8px !important;
        }
    }
    
    /* Ensure tutorial survives orientation changes */
    #gameTutorial {
        transition: none !important;
        -webkit-transition: none !important;
        -moz-transition: none !important;
        -o-transition: none !important;
    }
}

/* âœ… CRITICAL: Safe area support for all mobile devices */
:root {
    --safe-area-inset-top: env(safe-area-inset-top, 0px);
    --safe-area-inset-right: env(safe-area-inset-right, 0px);
    --safe-area-inset-bottom: env(safe-area-inset-bottom, 0px);
    --safe-area-inset-left: env(safe-area-inset-left, 0px);
    
    /* Default minimum safe areas */
    --safe-top: max(var(--safe-area-inset-top), 30px);
    --safe-right: max(var(--safe-area-inset-right), 25px);
    --safe-bottom: max(var(--safe-area-inset-bottom), 30px);
    --safe-left: max(var(--safe-area-inset-left), 25px);
    }

/* âœ… ANDROID SPECIFIC SAFE AREAS (S20 FE optimized) */
body.android-device {
    --safe-top: max(var(--safe-area-inset-top), 45px);
    --safe-right: max(var(--safe-area-inset-right), 35px);
    --safe-bottom: max(var(--safe-area-inset-bottom), 40px);
    --safe-left: max(var(--safe-area-inset-left), 35px);
}

/* âœ… SAMSUNG SPECIFIC SAFE AREAS (S20 FE optimized) */
body.samsung-device {
    --safe-top: max(var(--safe-area-inset-top), 60px);
    --safe-right: max(var(--safe-area-inset-right), 45px);
    --safe-bottom: max(var(--safe-area-inset-bottom), 50px);
    --safe-left: max(var(--safe-area-inset-left), 45px);
}

/* âœ… iOS SPECIFIC SAFE AREAS (already working well) */
body.ios-device {
    --safe-area-inset-top: env(safe-area-inset-top);
    --safe-area-inset-right: env(safe-area-inset-right);
    --safe-area-inset-bottom: env(safe-area-inset-bottom);
    --safe-area-inset-left: env(safe-area-inset-left);
    --safe-top: max(var(--safe-area-inset-top), 35px);
    --safe-right: max(var(--safe-area-inset-right), 25px);
    --safe-bottom: max(var(--safe-area-inset-bottom), 35px);
    --safe-left: max(var(--safe-area-inset-left), 25px);
}

/* ðŸ”¥ NUCLEAR CSS OVERRIDE: These rules MUST be last to override everything */
@media only screen and (max-width: 950px) {
    /* NUCLEAR: Force mobile controls container to NEVER disappear */
    body #mobile-controls,
    #mobile-controls,
    html #mobile-controls,
    * #mobile-controls {
        display: block !important;
        visibility: visible !important;
        opacity: 1 !important;
        position: fixed !important;
        z-index: 2147483647 !important; /* Maximum z-index */
    }
    
    /* NUCLEAR: Force joystick to NEVER disappear */
    body .joystick-container,
    .joystick-container,
    html .joystick-container,
    * .joystick-container {
        display: flex !important;
        visibility: visible !important;
        opacity: 1 !important;
        position: absolute !important;
        pointer-events: auto !important;
        z-index: 2147483646 !important;
    }
    
    /* NUCLEAR: Force mobile buttons to NEVER disappear */
    body .mobile-buttons,
    .mobile-buttons,
    html .mobile-buttons,
    * .mobile-buttons {
        display: flex !important;
        visibility: visible !important;
        opacity: 1 !important;
        position: absolute !important;
        pointer-events: auto !important;
        z-index: 2147483646 !important;
        flex-direction: column !important;
    }
    
    /* NUCLEAR: Force individual buttons to NEVER disappear */
    body #fly-up-btn,
    body #fly-down-btn,
    body #attack-btn,
    body .mobile-btn,
    #fly-up-btn,
    #fly-down-btn,
    #attack-btn,
    .mobile-btn,
    html #fly-up-btn,
    html #fly-down-btn,
    html #attack-btn,
    html .mobile-btn,
    * #fly-up-btn,
    * #fly-down-btn,
    * #attack-btn,
    * .mobile-btn {
        display: flex !important;
        visibility: visible !important;
        opacity: 1 !important;
        pointer-events: auto !important;
        position: relative !important;
        z-index: 2147483645 !important;
    }
} 