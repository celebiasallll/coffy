<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <meta name="theme-color" content="#3a2614">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Coffyverse">
    <title>Coffyverse</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="mobile.css" id="mobile-style" media="(orientation: landscape) and (max-width: 933px), (orientation: portrait) and (max-width: 949px)">
    <style>
      html, body {
        width: 100vw; height: 100vh; margin: 0; padding: 0;
        overflow: hidden; /* Mobilde scroll'u engelle */
        touch-action: none; /* Mobilde zoom/scroll engelle */
        overscroll-behavior: none;
        background: #3a2614;
      }
      body {
        -webkit-user-select: none; user-select: none;
        -webkit-touch-callout: none;
        -webkit-tap-highlight-color: transparent;
      }
      #mobileDebugPanel {
        position: fixed;
        bottom: 10px;
        left: 10px;
        background: rgba(0,0,0,0.5);
        color: #ffd700;
        font-size: 10px;
        padding: 5px;
        border-radius: 4px;
        z-index: 9999;
        display: none;
        pointer-events: auto;
        font-family: monospace;
      }
      #recoverControlsBtn {
        background: #ffd700;
        color: #000;
        border: none;
        padding: 3px 6px;
        font-size: 9px;
        margin-top: 4px;
        border-radius: 3px;
        cursor: pointer;
      }
    </style>
</head>
<body>
    <div id="loadingScreen" style="position:fixed;top:0;left:0;width:100vw;height:100vh;background:#3a2614;color:#ffd700;display:flex;align-items:center;justify-content:center;z-index:9999;font-size:22px;font-family:Arial,sans-serif;letter-spacing:0.04em;">Loading Coffyverse...</div>
    <div id="instructions">
        <h1>Coffy: Drive, Rescue, Earn</h1>
        <p>WASD to drive | SPACE to brake/drift | MOUSE to steer | F to fire | M to fire missile</p>
        <p>Press SHIFT+P for police car | SHIFT+T for thief car | SHIFT+C for courier car</p>
        <div id="introButtons">
            <button id="startButton">Start Game</button>
        </div>
    </div>
    
    <div id="pauseOverlay" style="display:none;">
        <div>
            <h2>Game Paused</h2>
            <button id="resumeButton">Resume Game</button>
            <button id="mainMenuButton">Main Menu</button>
        </div>
    </div>
    
    <!-- Mobile Debug Panel -->
    <div id="mobileDebugPanel">
        <div>FPS: <span id="debugFps">--</span></div>
        <div>Joystick: <span id="debugJoystick">--</span></div>
        <div>Graphics: <span id="debugGraphics">--</span></div>
        <button id="recoverControlsBtn">Recover Controls</button>
    </div>

    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.151.0/build/three.module.js",
                "three/addons/": "https://unpkg.com/three@0.151.0/examples/jsm/"
            }
        }
    </script>
    <script type="module" src="main.js"></script>
    <script src="nipplejs.min.js"></script>
    <script src="mobileHud.js"></script>
    <script>
        // Initialize debug panel for mobile
        document.addEventListener('DOMContentLoaded', function() {
            const isMobile = window.innerWidth <= 950 || /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
            
            if (isMobile) {
                const debugPanel = document.getElementById('mobileDebugPanel');
                const fpsDisplay = document.getElementById('debugFps');
                const joystickDisplay = document.getElementById('debugJoystick');
                const graphicsDisplay = document.getElementById('debugGraphics');
                const recoverBtn = document.getElementById('recoverControlsBtn');
                
                // Enable debug panel with double tap in bottom left corner
                let lastTap = 0;
                document.addEventListener('touchstart', function(e) {
                    const touch = e.touches[0];
                    if (touch.clientX < 50 && touch.clientY > window.innerHeight - 50) {
                        const now = new Date().getTime();
                        const timeSince = now - lastTap;
                        if (timeSince < 300 && timeSince > 0) {
                            debugPanel.style.display = debugPanel.style.display === 'none' ? 'block' : 'none';
                        }
                        lastTap = now;
                    }
                });
                
                // Update debug info every second
                setInterval(function() {
                    if (debugPanel.style.display === 'block') {
                        // Update FPS
                        fpsDisplay.textContent = window.fpsHistory && window.fpsHistory.length > 0 ? 
                            Math.round(window.fpsHistory[window.fpsHistory.length-1]) : '--';
                        
                        // Update joystick status
                        joystickDisplay.textContent = document.querySelector('.nipple') ? 'OK' : 'ERROR';
                        
                        // Update graphics mode
                        graphicsDisplay.textContent = window.lowGraphicsMode ? 'LOW' : 'NORMAL';
                    }
                }, 1000);
                
                // Recover controls button
                recoverBtn.addEventListener('click', function() {
                    if (window.mobileHud && typeof window.mobileHud.forceRefresh === 'function') {
                        window.mobileHud.forceRefresh();
                        if (window.showNotification) {
                            window.showNotification('Kontroller yenilendi!', 2000);
                        }
                    }
                });
            }
        });
    </script>
</body>
</html> 